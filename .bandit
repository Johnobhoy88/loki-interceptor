# Bandit security testing configuration

[bandit]
# Paths to exclude from security scanning
exclude_dirs = [
    '/test',
    '/tests',
    '/.venv',
    '/venv',
    '/migrations',
]

# Tests to run
tests = [
    'B101',  # assert_used - asserts should not be used in production code
    'B102',  # exec_used - use of exec function
    'B103',  # set_bad_file_permissions - insecure file permissions
    'B104',  # hardcoded_bind_all_interfaces - binding to all interfaces
    'B105',  # hardcoded_password_string - hardcoded passwords
    'B106',  # hardcoded_password_funcarg - hardcoded passwords in function args
    'B107',  # hardcoded_password_default - hardcoded passwords in defaults
    'B108',  # hardcoded_tmp_directory - hardcoded temp directory usage
    'B110',  # try_except_pass - try-except-pass blocks
    'B111',  # execute_with_run_as_root_equals_true - run as root
    'B112',  # sleep_exists - sleep exists in code
    'B201',  # flask_debug_true - Flask debug mode enabled
    'B301',  # pickle - pickle usage (potential vulnerability)
    'B302',  # marshal - marshal usage
    'B303',  # md5 - use of MD5 hash
    'B304',  # des - use of DES encryption
    'B305',  # cipher - weak cipher usage
    'B306',  # mktemp - insecure temporary file handling
    'B307',  # eval - use of eval()
    'B308',  # mark_safe - unsafe HTML marking in Django
    'B309',  # httpsconnection - unencrypted HTTP connection
    'B310',  # urllib_urlopen - urllib URL handling
    'B311',  # random - weak random number generation
    'B312',  # telnetlib - insecure telnet usage
    'B313',  # xml_bad_etree - XML vulnerabilities
    'B314',  # xml_bad_expat - XML vulnerabilities
    'B315',  # xml_bad_dom - XML vulnerabilities
    'B316',  # xml_bad_sax - XML vulnerabilities
    'B317',  # xml_bad_pulldom - XML vulnerabilities
    'B318',  # xml_bad_etree_lxml - XML vulnerabilities
    'B319',  # xml_bad_expatbuilder - XML vulnerabilities
    'B320',  # xml_bad_expatreader - XML vulnerabilities
    'B321',  # ftplib - insecure FTP usage
    'B322',  # unverified_context - unverified SSL context
    'B323',  # unverified_request - unverified HTTP requests
    'B324',  # tempnam - insecure temp file handling
    'B325',  # temp_file_q_set_unique - temp file handling
    'B401',  # import_telnetlib - insecure telnet import
    'B402',  # import_ftplib - insecure FTP import
    'B403',  # import_pickle - pickle import
    'B404',  # import_subprocess - subprocess import
    'B405',  # import_xml - XML import
    'B406',  # import_xmldom - XML DOM import
    'B407',  # import_xmlrpc - XML-RPC import
    'B408',  # import_shelve - shelve import
    'B409',  # import_marshal - marshal import
    'B410',  # import_msilib - msilib import
    'B411',  # import_xmlrpclib - XML-RPC lib import
    'B412',  # import_httpoxy - httpoxy vulnerability
    'B413',  # import_pycrypto - PyCrypto import (use cryptography instead)
    'B501',  # request_verify_false - requests verify=False
    'B502',  # ssl_verify_false - SSL verification disabled
    'B503',  # ssl_insecure_version - insecure SSL version
    'B504',  # ssl_with_bad_version - bad SSL version
    'B505',  # weak_cryptographic_key - weak encryption key
    'B506',  # yaml_load - unsafe YAML loading
    'B507',  # ssh_no_host_key_verification - SSH without key verification
    'B601',  # paramiko_calls - insecure paramiko usage
    'B602',  # shell_injection - shell injection vulnerability
    'B603',  # subprocess_without_shell_equals_true - subprocess with shell=True
    'B604',  # any_other_function_with_shell_equals_true - other shell=True
    'B605',  # start_process_with_a_shell - process with shell
    'B606',  # start_process_with_no_shell - process without shell (might miss issues)
    'B607',  # partial_paramiko_calls - partial paramiko calls
    'B608',  # hardcoded_sql_statements - SQL injection
    'B609',  # wildcard_use_in_except_handler - overly broad except
    'B610',  # django_sql_injection - Django SQL injection
    'B611',  # sqlalchemy_sql_injection - SQLAlchemy injection
]

# Test exclusions for specific scenarios
skips = [
    'B101',  # In test files, asserts are acceptable
]
